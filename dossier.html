<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enval – Dossier</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      .statusbar { display:flex; gap:12px; align-items:center; justify-content:space-between; }
      .pill { display:inline-block; padding:6px 10px; border-radius:999px; font-weight:600; font-size:0.85rem; border:1px solid #cbd5e1; background:#fff; }
      .pill.ok { border-color:#22c55e; }
      .pill.warn { border-color:#f59e0b; }
      .pill.err { border-color:#ef4444; }
      .muted { color:#64748b; }
      .grid2 { display:grid; gap:16px; }
      @media (min-width:768px){ .grid2 { grid-template-columns: 1fr 1fr; } }
      .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
      .table { width:100%; border-collapse:collapse; }
      .table th, .table td { border-bottom:1px solid #e2e8f0; padding:10px 6px; text-align:left; font-size:0.95rem; vertical-align:top; }
      .table th { font-size:0.85rem; color:#64748b; font-weight:600; }
      .right { text-align:right; }
      .small { font-size:0.85rem; }
      .hidden { display:none !important; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
      .is-loading { opacity: 0.75; }
      .notice { background:#f8fafc; border:1px solid #e2e8f0; padding:10px; border-radius:10px; }
      .danger { color:#b91c1c; }
      .ok { color:#15803d; }
    </style>
  </head>

  <body>
    <header>
      <div class="container header-inner">
        <div class="logo"><a href="/index.html">Enval</a></div>
        <nav>
          <a href="/index.html">Home</a>
          <a href="/hoe-het-werkt.html">Hoe het werkt</a>
          <a href="/regelgeving.html">Regelgeving</a>
          <a href="/index.html#contact">Contact</a>
        </nav>
      </div>
    </header>

    <main>
      <section class="section">
        <div class="container">
          <div class="card">
            <div class="statusbar">
              <div>
                <h1 style="margin:0 0 6px 0;">Jouw Enval dossier</h1>
                <div class="muted small">
                  Dossier: <span id="dossierId" class="mono">-</span>
                </div>
              </div>
              <div class="row">
                <span id="statusPill" class="pill">laden…</span>
                <button id="btnRefresh" class="btn outline" type="button">Ververs</button>
              </div>
            </div>

            <div style="margin-top:14px;">
              <div class="muted">
                Vul onderstaande stappen in. Na elke stap kun je het dossier laten controleren via <b>Review dossier</b>.
              </div>
              <div id="lockedBanner" class="notice hidden" style="margin-top:10px;">
                <b>Dit dossier is ingediend en staat in review.</b><br/>
                Wijzigingen zijn nu vergrendeld.
              </div>
            </div>
          </div>

          <div class="grid2" style="margin-top:18px;">
            <div class="card">
              <h2 style="margin-top:0;">1) Toegang</h2>

              <div class="muted small">E-mail (vast):</div>
              <div id="emailState" class="mono" style="margin:6px 0 12px 0;">laden…</div>

              <form id="accessForm" class="form" novalidate>
                <label><span>Mobiel (optioneel)</span><input type="text" name="customer_phone" placeholder="06xxxxxxxx of +316xxxxxxxx" /></label>

                <label>
                  <span>Aantal laadpunten</span>
                  <select name="charger_count" required>
                    <option value="">Kies…</option>
                    <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option>
                    <option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option>
                    <option value="9">9</option><option value="10">10</option>
                  </select>
                </label>

                <label>
                  <span>Op eigen terrein?</span>
                  <select name="own_premises" required>
                    <option value="">Kies…</option>
                    <option value="ja">Ja</option>
                    <option value="nee">Nee</option>
                  </select>
                </label>

                <button id="btnAccessSave" class="btn primary" type="submit">Opslaan</button>
                <div id="accessState" class="small muted"></div>
              </form>

              <div id="accessSummary" class="notice small" style="margin-top:12px;">laden…</div>
            </div>

            <div class="card">
              <h2 style="margin-top:0;">2) Adres</h2>
              <form id="addressForm" class="form" novalidate>
                <label><span>Postcode</span><input type="text" name="postcode" placeholder="1234AB" required /></label>
                <label><span>Huisnummer</span><input type="text" name="house_number" placeholder="28" required /></label>
                <label><span>Toevoeging (optioneel)</span><input type="text" name="suffix" placeholder="1H" /></label>

                <label><span>Straat</span><input type="text" name="street_ro" readonly /></label>
                <label><span>Plaats</span><input type="text" name="city_ro" readonly /></label>

                <div class="row">
                  <button id="btnAddressSave" type="submit" class="btn primary" disabled>Opslaan</button>
                </div>

                <div id="addressState" class="small muted"></div>
              </form>
            </div>

            <div class="card">
              <h2 style="margin-top:0;">3) Laadpalen</h2>
              <div id="chargerHint" class="notice small" style="margin-bottom:10px;">laden…</div>

              <form id="chargerForm" class="form" novalidate>
                <input type="hidden" name="charger_id" />
                <label><span>Serienummer (verplicht)</span><input type="text" name="serial_number" placeholder="SN123456" required /></label>

                <label><span>Merk</span><select id="chargerBrand" required></select></label>
                <label><span>Model</span><select id="chargerModel" required></select></label>

                <label><span>Vermogen kW (optioneel)</span><input type="text" name="power_kw" placeholder="11" /></label>

                <label id="chargerNotesRow" class="hidden">
                  <span>Toelichting (verplicht bij Anders)</span>
                  <input type="text" name="notes" placeholder="Vul merk en model in (bijv. MyBrand X200)" />
                </label>

                <div class="row">
                  <button id="btnChargerSave" type="submit" class="btn primary">Opslaan</button>
                </div>
              </form>

              <div style="margin-top:14px;">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Serienummer</th>
                      <th>Merk</th>
                      <th>Model</th>
                      <th>Toelichting</th>
                      <th class="right">Acties</th>
                    </tr>
                  </thead>
                  <tbody id="chargersTbody">
                    <tr><td colspan="5" class="muted">laden…</td></tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="card">
              <h2 style="margin-top:0;">4) Documenten uploaden</h2>
              <div id="docsHint" class="notice small" style="margin-bottom:10px;">laden…</div>

              <form id="uploadForm" class="form" novalidate>
                <label>
                  <span>Type document</span>
                  <select name="doc_type" required>
                    <option value="">Kies…</option>
                    <option value="factuur">Factuur Installatie</option>
                    <option value="foto_laadpunt">Foto Laadpunt</option>
                  </select>
                </label>

                <label><span>Bestand</span><input type="file" name="file" required accept=".pdf,.png,.jpg,.jpeg,.doc,.docx,application/pdf,image/png,image/jpeg,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" /></label>

                <button id="btnUpload" class="btn primary" type="submit">Upload</button>
                <div id="uploadState" class="small muted"></div>
              </form>

              <div style="margin-top:14px;">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Type</th>
                      <th>Bestand</th>
                      <th>Wanneer</th>
                      <th class="right">Acties</th>
                    </tr>
                  </thead>
                  <tbody id="docsTbody">
                    <tr><td colspan="4" class="muted">laden…</td></tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="card">
              <h2 style="margin-top:0;">5) Toestemmingen</h2>
              <form id="consentsForm" class="form" novalidate>
                <div class="checkbox-row">
                  <input type="checkbox" id="cTerms" />
                  <label for="cTerms">Ik ga akkoord met de <a href="/voorwaarden.html" target="_blank" rel="noopener">voorwaarden</a></label>
                </div>
                <div class="checkbox-row">
                  <input type="checkbox" id="cPrivacy" />
                  <label for="cPrivacy">Ik ga akkoord met de <a href="/privacyverklaring.html" target="_blank" rel="noopener">privacyverklaring</a></label>
                </div>
                <div class="checkbox-row">
                  <input type="checkbox" id="cMandaat" />
                  <label for="cMandaat">Ik geef middels dit <a href="/mandaat.html" target="_blank" rel="noopener">mandaat</a> toestemming.</label>
                </div>

                <button id="btnConsentsSave" class="btn primary" type="submit">Opslaan</button>
                <div id="consentsState" class="small muted"></div>
                <div id="consentsStamp" class="small muted"></div>
              </form>
            </div>

            <div class="card">
              <h2 style="margin-top:0;">Review</h2>
              <div id="statusExplain" class="muted small">laden…</div>
              <div class="row" style="margin-top:10px;">
                <button id="btnEvaluate" class="btn outline" type="button">Review dossier</button>
              </div>
              <div id="reviewState" class="small muted" style="margin-top:8px;"></div>
            </div>
          </div>

          <div style="height:24px;"></div>
        </div>
      </section>
    </main>

    <footer>
      <div class="container footer-inner">
        <p>&copy; <span id="year"></span> Enval. Alle rechten voorbehouden.</p>
      </div>
    </footer>

    <script src="/config.js"></script>
    <script src="/dossier.js"></script>
  </body>
</html>
